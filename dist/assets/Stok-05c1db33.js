import{a as r}from"./axios-8e4517c3.js";import{S as i}from"./sweetalert2-50e64164.js";import{S as v}from"./Sidebar-a1931b7f.js";import{N as y,F as S}from"./Footer-f986833d.js";import{_ as k,h as d,o as m,c as u,g as c,n as C,a as e,F as w,i as x,t as l,b as p,v as F,j as E}from"./index-73a52fd5.js";const I={name:"MenuManagement",components:{Sidebar:v,Navbar:y,Footer:S},data(){return{sidebarToggled:!1,sidebarClass:"",menus:[],form:{id:"",name:"",jenis:"",image:null},isEdit:!1,modalInstance:null}},methods:{toggleSidebar(){this.sidebarToggled=!this.sidebarToggled,this.sidebarClass=this.sidebarToggled?"toggle-sidebar":""},async fetchMenus(){try{const n=await r.get("https://apirental.keuanganfpti.com/api/menu/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.menus=n.data.data}catch(n){console.error("Error fetching menu:",n)}},handleFileUpload(n){this.form.image=n.target.files[0]},async submitForm(){const n=new FormData;this.isEdit&&n.append("id",this.form.id),n.append("name",this.form.name),n.append("jenis",this.form.jenis),this.form.image&&n.append("image",this.form.image);const t=this.isEdit?"/menu/update":"/menu/create";try{const h=await r.post(`https://apirental.keuanganfpti.com/api${t}`,n,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});i.fire("Success!",this.isEdit?"Menu updated successfully":"Menu created successfully","success"),this.hideModal(),this.resetForm(),this.fetchMenus()}catch{i.fire("Error!","An error occurred while processing the request.","error")}},openModal(n,t=null){this.isEdit=n==="update",this.isEdit&&t?this.form={...t,image:null}:this.resetForm(),this.modalInstance=new bootstrap.Modal(this.$refs.menuModalRef),this.modalInstance.show()},hideModal(){this.modalInstance&&this.modalInstance.hide()},resetForm(){this.form={id:"",name:"",jenis:"",image:null},this.isEdit=!1},async deleteMenu(n){try{(await i.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed&&(await r.delete(`https://apirental.keuanganfpti.com/api/menu/delete/${n}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}}),i.fire("Deleted!","Menu has been deleted.","success"),this.fetchMenus())}catch{i.fire("Error!","An error occurred while deleting the menu.","error")}}},created(){this.fetchMenus()}},B={id:"wrapper"},N={id:"content-wrapper",class:"d-flex flex-column"},T={id:"content"},j={class:"container-fluid mt-4"},A={class:"table"},P=["src"],U=["onClick"],D=["onClick"],z={class:"modal fade",id:"menuModal",tabindex:"-1","aria-labelledby":"menuModalLabel","aria-hidden":"true",ref:"menuModalRef"},V={class:"modal-dialog modal-lg modal-dialog-centered"},L={class:"modal-content"},J={class:"modal-header"},R={class:"modal-title",id:"menuModalLabel"},Y={class:"modal-body"},q={class:"modal-footer"};function G(n,t,h,H,a,o){const f=d("Sidebar"),b=d("Navbar"),g=d("Footer");return m(),u("div",B,[c(f,{class:C(a.sidebarClass)},null,8,["class"]),e("div",N,[e("div",T,[c(b,{onToggleSidebar:o.toggleSidebar},null,8,["onToggleSidebar"]),e("div",j,[t[8]||(t[8]=e("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Stok PS",-1)),e("button",{class:"btn btn-primary mb-3",onClick:t[0]||(t[0]=s=>o.openModal("create"))}," Add Menu "),e("table",A,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"No"),e("th",null,"Image"),e("th",null,"Name"),e("th",null,"Jenis"),e("th",null,"Actions")])],-1)),e("tbody",null,[(m(!0),u(w,null,x(a.menus,(s,_)=>(m(),u("tr",{key:s.id},[e("td",null,l(_+1),1),e("td",null,[e("img",{src:`https://apirental.keuanganfpti.com/storage/${s.image}`,alt:"Menu Image",style:{"max-width":"100px","max-height":"100px"}},null,8,P)]),e("td",null,l(s.name),1),e("td",null,l(s.jenis),1),e("td",null,[e("button",{class:"btn btn-warning btn-sm me-2",onClick:M=>o.openModal("update",s)}," Edit ",8,U),e("button",{class:"btn btn-danger btn-sm",onClick:M=>o.deleteMenu(s.id)}," Delete ",8,D)])]))),128))])])]),c(g)])]),e("div",z,[e("div",V,[e("div",L,[e("div",J,[e("h5",R,l(a.isEdit?"Update Menu":"Create Menu"),1),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:t[1]||(t[1]=(...s)=>o.hideModal&&o.hideModal(...s))},t[9]||(t[9]=[e("span",{"aria-hidden":"true"},"Ã—",-1)]))]),e("div",Y,[p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.form.name=s),class:"form-control mb-3",placeholder:"Menu Name"},null,512),[[F,a.form.name]]),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.form.jenis=s),class:"form-control mb-3"},t[10]||(t[10]=[e("option",{value:""},"Pilih Jenis PS",-1),e("option",{value:"PS 4"},"PS 4",-1),e("option",{value:"PS 5"},"PS 5",-1)]),512),[[E,a.form.jenis]]),e("input",{type:"file",class:"form-control mb-3",onChange:t[4]||(t[4]=(...s)=>o.handleFileUpload&&o.handleFileUpload(...s))},null,32)]),e("div",q,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[5]||(t[5]=(...s)=>o.hideModal&&o.hideModal(...s))},"Batal"),e("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(...s)=>o.submitForm&&o.submitForm(...s))},l(a.isEdit?"Update":"Create"),1)])])])],512)])}const Z=k(I,[["render",G],["__scopeId","data-v-0f0813a0"]]);export{Z as default};
