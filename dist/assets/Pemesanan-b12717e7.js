import{a as m}from"./axios-8e4517c3.js";import{S as l}from"./sweetalert2-50e64164.js";import{S}from"./Sidebar-a1931b7f.js";import{N as P,F as C}from"./Footer-f986833d.js";import{_ as B,h as u,o as r,c as d,g as c,n as x,a,F as b,i as h,t as i,b as p,v as f,j as E,k as g}from"./index-73a52fd5.js";const T={name:"PemesananManagement",components:{Sidebar:S,Navbar:P,Footer:C},data(){return{pemesananList:[],availableMenu:[],form:{id:"",tanggal_sewa:"",durasi:1,menu_id:""},isEdit:!1,modalInstance:null}},methods:{async fetchPemesanan(){try{const n=await m.get("https://apirental.keuanganfpti.com/api/pemesanan/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.pemesananList=n.data.data}catch(n){console.error("Error fetching pemesanan:",n)}},async fetchAvailableMenu(){if(this.form.tanggal_sewa)try{const n=await m.post("https://apirental.keuanganfpti.com/api/menu/available",{tanggal:this.form.tanggal_sewa},{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.availableMenu=n.data}catch(n){console.error("Error fetching available menu:",n)}},async submitForm(){const n=this.isEdit?"/pemesanan/update":"/pemesanan/create";try{const e=await m.post(`https://apirental.keuanganfpti.com/api${n}`,this.form,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});e.data&&e.data.data&&e.data.data.redirect_url?window.location.href=e.data.data.redirect_url:(l.fire("Success!",this.isEdit?"Pemesanan diperbarui!":"Pemesanan ditambahkan!","success"),this.hideModal(),this.fetchPemesanan())}catch{l.fire("Error!","Terjadi kesalahan dalam proses.","error")}},async deletePemesanan(n){if((await l.fire({title:"Yakin ingin menghapus?",icon:"warning",showCancelButton:!0,confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed)try{await m.delete(`https://apirental.keuanganfpti.com/api/pemesanan/delete/${n}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}}),l.fire("Berhasil!","Pemesanan berhasil dihapus.","success"),this.fetchPemesanan()}catch{l.fire("Error!","Gagal menghapus pemesanan.","error")}},openModal(n,e=null){this.isEdit=n==="update",this.form=e?{...e}:{id:"",tanggal_sewa:"",durasi:1,menu_id:"",user_id:""},this.modalInstance=new bootstrap.Modal(this.$refs.pemesananModalRef),this.modalInstance.show()},hideModal(){this.modalInstance&&this.modalInstance.hide()}},created(){this.fetchPemesanan()}},I={id:"wrapper"},F={id:"content-wrapper",class:"d-flex flex-column"},A={id:"content"},N={class:"container-fluid mt-4"},V={class:"table"},z=["onClick"],D=["onClick"],L={class:"modal fade",id:"pemesananModal",tabindex:"-1","aria-labelledby":"pemesananModalLabel","aria-hidden":"true",ref:"pemesananModalRef"},U={class:"modal-dialog modal-lg modal-dialog-centered"},j={class:"modal-content"},H={class:"modal-header"},R={class:"modal-title"},q={class:"modal-body"},G=["value"],Y={class:"modal-footer"};function J(n,e,_,K,s,o){const v=u("Sidebar"),w=u("Navbar"),M=u("Footer");return r(),d("div",I,[c(v,{class:x(n.sidebarClass)},null,8,["class"]),a("div",F,[a("div",A,[c(w,{onToggleSidebar:n.toggleSidebar},null,8,["onToggleSidebar"]),a("div",N,[e[10]||(e[10]=a("h1",{class:"h3 mb-0 text-gray-800 text-center mb-3"},"Manajemen Pemesanan",-1)),a("table",V,[e[9]||(e[9]=a("thead",null,[a("tr",null,[a("th",null,"No"),a("th",null,"Tanggal Sewa"),a("th",null,"Durasi"),a("th",null,"Menu"),a("th",null,"Status"),a("th",null,"Actions")])],-1)),a("tbody",null,[(r(!0),d(b,null,h(s.pemesananList,(t,y)=>(r(),d("tr",{key:t.id},[a("td",null,i(y+1),1),a("td",null,i(t.tanggal_sewa),1),a("td",null,i(t.durasi),1),a("td",null,i(t.menu.name),1),a("td",null,i(t.payment.status),1),a("td",null,[a("button",{class:"btn btn-warning btn-sm me-2",onClick:k=>o.openModal("update",t)},e[7]||(e[7]=[a("i",{class:"bi bi-pencil-square"},null,-1),g(" Edit ")]),8,z),a("button",{class:"btn btn-danger btn-sm",onClick:k=>o.deletePemesanan(t.id)},e[8]||(e[8]=[a("i",{class:"bi bi-trash3-fill"},null,-1),g(" Hapus ")]),8,D)])]))),128))])])]),c(M)])]),a("div",L,[a("div",U,[a("div",j,[a("div",H,[a("h5",R,i(s.isEdit?"Update Pemesanan":"Tambah Pemesanan"),1),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=(...t)=>o.hideModal&&o.hideModal(...t))},e[11]||(e[11]=[a("span",{"aria-hidden":"true"},"Ã—",-1)]))]),a("div",q,[e[13]||(e[13]=a("label",{for:"tanggal_sewa"},"Tanggal Sewa",-1)),p(a("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.form.tanggal_sewa=t),type:"date",class:"form-control mb-3",onChange:e[2]||(e[2]=(...t)=>o.fetchAvailableMenu&&o.fetchAvailableMenu(...t))},null,544),[[f,s.form.tanggal_sewa]]),e[14]||(e[14]=a("label",{for:"durasi"},"Durasi (hari)",-1)),p(a("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.form.durasi=t),type:"number",class:"form-control mb-3",placeholder:"Durasi"},null,512),[[f,s.form.durasi,void 0,{number:!0}]]),e[15]||(e[15]=a("label",{for:"menu_id"},"Menu Sewa",-1)),p(a("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.form.menu_id=t),class:"form-control mb-3"},[e[12]||(e[12]=a("option",{value:""},"Pilih Menu",-1)),(r(!0),d(b,null,h(s.availableMenu,t=>(r(),d("option",{key:t.id,value:t.id},i(t.name)+" - "+i(t.jenis),9,G))),128))],512),[[E,s.form.menu_id]])]),a("div",Y,[a("button",{type:"button",class:"btn btn-secondary",onClick:e[5]||(e[5]=(...t)=>o.hideModal&&o.hideModal(...t))}," Batal "),a("button",{type:"button",class:"btn btn-primary",onClick:e[6]||(e[6]=(...t)=>o.submitForm&&o.submitForm(...t))},i(s.isEdit?"Update":"Tambah"),1)])])])],512)])}const $=B(T,[["render",J],["__scopeId","data-v-17dc1db6"]]);export{$ as default};
