import{a as m}from"./axios-8e4517c3.js";import{S as d}from"./sweetalert2-50e64164.js";import{_,h as u,o as l,c as r,l as x,a,g as p,m as P,n as y,k as f,F as g,i as h,t as o,b as c,v,j as C}from"./index-73a52fd5.js";import{N as B,F as E}from"./Footer-f986833d.js";const T={},I={class:"nav-item"};function F(n,e){const b=u("router-link");return l(),r("ul",{class:y(["navbar-nav bg-light sidebar sidebar-dark accordion",{toggled:n.sidebarToggled}]),id:"accordionSidebar"},[e[1]||(e[1]=x('<a class="sidebar-brand d-flex align-items-center justify-content-center" href="#"><div class="sidebar-brand-icon mt-2"></div><div class="sidebar-brand-text ms-3"><span class="text-primary">Rental PS</span></div></a><div class="sidebar-heading mt-5 text-primary">Menu</div>',2)),a("li",I,[p(b,{class:"nav-link text-primary",to:"/pemesanan-ps","active-class":"font-weight-bold text-primary active-link"},{default:P(()=>e[0]||(e[0]=[a("i",{class:"bi bi-journal-text text-primary fw-bold"},null,-1),a("span",null,"Pemesanan",-1)])),_:1})]),e[2]||(e[2]=a("hr",{class:"sidebar-divider d-none d-md-block"},null,-1))],2)}const N=_(T,[["render",F]]);const A={name:"PemesananManagement",components:{Sidebar:N,Navbar:B,Footer:E},data(){return{pemesananList:[],availableMenu:[],form:{id:"",tanggal_sewa:"",durasi:1,menu_id:""},isEdit:!1,modalInstance:null}},methods:{async fetchPemesanan(){try{const n=await m.get("https://apirental.keuanganfpti.com/api/pemesanan/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.pemesananList=n.data.data}catch(n){console.error("Error fetching pemesanan:",n)}},async fetchAvailableMenu(){if(this.form.tanggal_sewa)try{const n=await m.post("https://apirental.keuanganfpti.com/api/menu/available",{tanggal:this.form.tanggal_sewa},{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.availableMenu=n.data}catch(n){console.error("Error fetching available menu:",n)}},async submitForm(){const n=this.isEdit?"/pemesanan/update":"/pemesanan/create";try{const e=await m.post(`https://apirental.keuanganfpti.com/api${n}`,this.form,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});e.data&&e.data.data&&e.data.data.redirect_url?window.location.href=e.data.data.redirect_url:(d.fire("Success!",this.isEdit?"Pemesanan diperbarui!":"Pemesanan ditambahkan!","success"),this.hideModal(),this.fetchPemesanan())}catch{d.fire("Error!","Terjadi kesalahan dalam proses.","error")}},async deletePemesanan(n){if((await d.fire({title:"Yakin ingin menghapus?",icon:"warning",showCancelButton:!0,confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed)try{await m.delete(`https://apirental.keuanganfpti.com/api/pemesanan/delete/${n}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}}),d.fire("Berhasil!","Pemesanan berhasil dihapus.","success"),this.fetchPemesanan()}catch{d.fire("Error!","Gagal menghapus pemesanan.","error")}},openModal(n,e=null){this.isEdit=n==="update",this.form=e?{...e}:{id:"",tanggal_sewa:"",durasi:1,menu_id:"",user_id:""},this.modalInstance=new bootstrap.Modal(this.$refs.pemesananModalRef),this.modalInstance.show()},hideModal(){this.modalInstance&&this.modalInstance.hide()}},created(){this.fetchPemesanan()}},j={id:"wrapper"},U={id:"content-wrapper",class:"d-flex flex-column"},V={id:"content"},z={class:"container-fluid mt-4"},R={class:"table"},D=["onClick"],L={class:"modal fade",id:"pemesananModal",tabindex:"-1","aria-labelledby":"pemesananModalLabel","aria-hidden":"true",ref:"pemesananModalRef"},q={class:"modal-dialog modal-lg modal-dialog-centered"},G={class:"modal-content"},H={class:"modal-header"},Y={class:"modal-title"},J={class:"modal-body"},K=["value"],O={class:"modal-footer"};function Q(n,e,b,W,s,i){const k=u("Sidebar"),w=u("Navbar"),M=u("Footer");return l(),r("div",j,[p(k,{class:y(n.sidebarClass)},null,8,["class"]),a("div",U,[a("div",V,[p(w,{onToggleSidebar:n.toggleSidebar},null,8,["onToggleSidebar"]),a("div",z,[e[11]||(e[11]=a("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Manajemen Pemesanan",-1)),a("button",{class:"btn btn-primary mb-3",onClick:e[0]||(e[0]=t=>i.openModal("create"))},e[8]||(e[8]=[a("i",{class:"bi bi-plus-lg"},null,-1),f(" Pemesanan ")])),a("table",R,[e[10]||(e[10]=a("thead",null,[a("tr",null,[a("th",null,"No"),a("th",null,"Tanggal Sewa"),a("th",null,"Durasi"),a("th",null,"Menu"),a("th",null,"Status"),a("th",null,"Actions")])],-1)),a("tbody",null,[(l(!0),r(g,null,h(s.pemesananList,(t,S)=>(l(),r("tr",{key:t.id},[a("td",null,o(S+1),1),a("td",null,o(t.tanggal_sewa),1),a("td",null,o(t.durasi),1),a("td",null,o(t.menu.name),1),a("td",null,o(t.payment.status),1),a("td",null,[a("button",{class:"btn btn-warning btn-sm me-2",onClick:X=>i.openModal("update",t)},e[9]||(e[9]=[a("i",{class:"bi bi-pencil-square"},null,-1),f(" Edit ")]),8,D)])]))),128))])])]),p(M)])]),a("div",L,[a("div",q,[a("div",G,[a("div",H,[a("h5",Y,o(s.isEdit?"Update Pemesanan":"Tambah Pemesanan"),1),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:e[1]||(e[1]=(...t)=>i.hideModal&&i.hideModal(...t))},e[12]||(e[12]=[a("span",{"aria-hidden":"true"},"Ã—",-1)]))]),a("div",J,[e[14]||(e[14]=a("label",{for:"tanggal_sewa"},"Tanggal Sewa",-1)),c(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.form.tanggal_sewa=t),type:"date",class:"form-control mb-3",onChange:e[3]||(e[3]=(...t)=>i.fetchAvailableMenu&&i.fetchAvailableMenu(...t))},null,544),[[v,s.form.tanggal_sewa]]),e[15]||(e[15]=a("i",{style:{color:"red","font-size":"10px"}},"* khusus weekend akan dikenakan biaya tambahan Rp. 50.000",-1)),e[16]||(e[16]=a("br",null,null,-1)),e[17]||(e[17]=a("label",{for:"durasi"},"Durasi (hari)",-1)),c(a("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.form.durasi=t),type:"number",class:"form-control mb-3",placeholder:"Durasi"},null,512),[[v,s.form.durasi,void 0,{number:!0}]]),e[18]||(e[18]=a("label",{for:"menu_id"},"Menu Sewa",-1)),c(a("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.form.menu_id=t),class:"form-control mb-3"},[e[13]||(e[13]=a("option",{value:""},"Pilih Menu",-1)),(l(!0),r(g,null,h(s.availableMenu,t=>(l(),r("option",{key:t.id,value:t.id},o(t.name)+" - "+o(t.jenis)+" - "+o(t.jenis==="PS 4"?"Rp. 30.000 / sesi":"Rp. 40.000 / sesi"),9,K))),128))],512),[[C,s.form.menu_id]])]),a("div",O,[a("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=(...t)=>i.hideModal&&i.hideModal(...t))}," Batal "),a("button",{type:"button",class:"btn btn-primary",onClick:e[7]||(e[7]=(...t)=>i.submitForm&&i.submitForm(...t))},o(s.isEdit?"Update":"Tambah"),1)])])])],512)])}const te=_(A,[["render",Q],["__scopeId","data-v-5e14e975"]]);export{te as default};
